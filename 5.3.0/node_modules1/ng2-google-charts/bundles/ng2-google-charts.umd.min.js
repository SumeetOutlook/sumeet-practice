!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core")):"function"==typeof define&&define.amd?define("ng2-google-charts",["exports","@angular/core"],e):e((t=t||self)["ng2-google-charts"]={},t.ng.core)}(this,(function(t,e){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function o(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a}function r(t,e){return function(o,r){e(o,r,t)}}function n(t,e,o,r){return new(o||(o=Promise))((function(n,i){function a(t){try{l(r.next(t))}catch(t){i(t)}}function s(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){t.done?n(t.value):new o((function(e){e(t.value)})).then(a,s)}l((r=r.apply(t,e||[])).next())}))}function i(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function a(t){var e="function"==typeof Symbol&&t[Symbol.iterator],o=0;return e?e.call(t):{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}}}var s=function(){function t(t,o){var r=this;this.googleChartsSettings=o,this.googleScriptLoadingNotifier=new e.EventEmitter,this.googleScriptIsLoading=!1,this.localeId=t,this.loadGoogleChartsScriptPromise=new Promise((function(t,e){if("undefined"!=typeof google&&google.charts)t();else if(r.googleScriptIsLoading)r.googleScriptLoadingNotifier.subscribe((function(o){o?t():e()}));else{r.googleScriptIsLoading=!0;var o=document.createElement("script");o.type="text/javascript",o.src="https://www.gstatic.com/charts/loader.js",o.async=!0,o.defer=!0,o.onload=function(){r.googleScriptIsLoading=!1,r.googleScriptLoadingNotifier.emit(!0),t()},o.onerror=function(){r.googleScriptIsLoading=!1,r.googleScriptLoadingNotifier.emit(!1),e()},document.getElementsByTagName("head")[0].appendChild(o)}}))}return t.prototype.load=function(t){return n(this,void 0,void 0,(function(){var e=this;return i(this,(function(o){switch(o.label){case 0:return[4,this.loadGoogleChartsScriptPromise];case 1:return o.sent(),[4,new Promise((function(o){t||(t=Object.create(e.googleChartsSettings)),t||(t={}),t.language||(t.language=e.localeId),t.googleChartsVersion||(t.googleChartsVersion="47");var r=t;r.callback=o,google.charts.load(t.googleChartsVersion,r)}))];case 2:return o.sent(),[2]}}))}))},t.ctorParameters=function(){return[{type:String,decorators:[{type:e.Inject,args:[e.LOCALE_ID]}]},{type:void 0,decorators:[{type:e.Inject,args:["googleChartsSettings"]},{type:e.Optional}]}]},t.ɵprov=e["ɵɵdefineInjectable"]({factory:function(){return new t(e["ɵɵinject"](e.LOCALE_ID),e["ɵɵinject"]("googleChartsSettings",8))},token:t,providedIn:"root"}),t=o([e.Injectable({providedIn:"root"}),r(0,e.Inject(e.LOCALE_ID)),r(1,e.Inject("googleChartsSettings")),r(1,e.Optional())],t)}(),l=function(){function t(t){this.opt=t,this.dataTableChanged=new e.EventEmitter,t&&this._setDataTable(t.dataTable,t.firstRowIsData)}return t.prototype.send=function(){var t=this;void 0!==this.query&&this.query.send((function(e){t.setDataTable(e.getDataTable()),t.opt.queryCallback&&t.opt.queryCallback(e)}))},t.prototype.init=function(t){var e=this;t&&(this.opt=t),void 0!==this.tid&&(window.clearInterval(this.tid),this.tid=void 0),this.opt.dataSourceUrl?(this.query=new google.visualization.Query(this.opt.dataSourceUrl),this.opt.query&&this.query.setQuery(this.opt.query),void 0!==this.opt.timeout&&this.query.setTimeout(this.opt.timeout),this.opt.refreshInterval&&(this.tid=window.setInterval((function(){e.send()}),1e3*this.opt.refreshInterval)),this.send()):this.setDataTable(this.opt.dataTable)},t.prototype.getDataTable=function(){return this.dataTable},t.prototype.setDataTable=function(t,e){void 0===e&&(e=this.opt.firstRowIsData),this._setDataTable(t,e),this.dataTableChanged.emit(this.dataTable)},t.prototype._setDataTable=function(t,e){Array.isArray(t)&&(t=google.visualization.arrayToDataTable(t,e)),this.dataTable=t,this.reformat()},t.prototype.reformat=function(){var t,e,o,r,n,i,s=this.dataTable;if(void 0!==s&&void 0!==this.opt.formatters)try{for(var l=a(this.opt.formatters),u=l.next();!u.done;u=l.next()){var c=u.value,p=void 0;if("PatternFormat"!==c.type){var h=google.visualization[c.type],d=c.options;if(p=new h(d),"ColorFormat"===c.type&&d){w=d;try{for(var g=(o=void 0,a(w.ranges)),v=g.next();!v.done;v=g.next()){var f=v.value;void 0!==f.fromBgColor&&void 0!==f.toBgColor?p.addGradientRange(f.from,f.to,f.color,f.fromBgColor,f.toBgColor):p.addRange(f.from,f.to,f.color,f.bgcolor)}}catch(t){o={error:t}}finally{try{v&&!v.done&&(r=g.return)&&r.call(g)}finally{if(o)throw o.error}}}try{for(var m=(n=void 0,a(c.columns)),y=m.next();!y.done;y=m.next()){var b=y.value;p.format(s,b)}}catch(t){n={error:t}}finally{try{y&&!y.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}}else{var w=c.options;(p=new google.visualization.PatternFormat(w.pattern)).format(s,c.columns,w.dstColumnIndex)}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}},o([e.Output()],t.prototype,"dataTableChanged",void 0),t}(),u=function(){function t(t){this.tooltipDOMElement=t}return t.prototype.setPosition=function(e,o){this.tooltipDOMElement.nativeElement.style.left=e+t.PIXELS,this.tooltipDOMElement.nativeElement.style.top=o+t.PIXELS},t.prototype.getDOMElement=function(){return this.tooltipDOMElement},t.PIXELS="px",t}(),c=function(){function t(t,o){var r=this;this.el=t,this.mouseOverListener=function(t){var e=r.parseMouseEvent(t);return e.tooltip=r.getHTMLTooltip(),e},this.mouseOutListener=function(t){return r.parseMouseEvent(t)},this.selectListener=function(){var t={message:"select",row:null,column:null,selectedRowValues:[],selectedRowFormattedValues:[],columnLabel:""},e=r.wrapper.visualization.getSelection(),o=e[e.length-1];if(!o)return t.message="deselect",t;var n=o;if(null!=o.row){t.row=n.row;for(var i=[],a=[],s=r.wrapper.getDataTable(),l=s.getNumberOfColumns(),u=0;u<l;u++)i.push(s.getValue(n.row,u)),a.push(s.getFormattedValue(n.row,u));t.selectedRowValues=i,t.selectedRowFormattedValues=a}return null!=n.column&&(t.column=n.column,t.columnLabel=r.getColumnLabelAtPosition(n)),o.name&&(t.columnLabel=o.name),t},this.loaderService=o,this.chartSelect=new e.EventEmitter,this.chartSelectOneTime=new e.EventEmitter,this.chartReady=new e.EventEmitter,this.chartReadyOneTime=new e.EventEmitter,this.chartError=new e.EventEmitter,this.chartErrorOneTime=new e.EventEmitter,this.mouseOver=new e.EventEmitter,this.mouseOverOneTime=new e.EventEmitter,this.mouseOut=new e.EventEmitter,this.mouseOutOneTime=new e.EventEmitter,this.regionClick=new e.EventEmitter,this.regionClickOneTime=new e.EventEmitter}return t.prototype.ngOnInit=function(){var t=this;this.HTMLel=this.el.nativeElement.querySelector("div"),this.data.component=this,this.options=this.data.options,this.init().then((function(){t.draw()}))},t.prototype.init=function(){return n(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.loaderService.load()];case 1:return t.sent(),this.recreateWrapper(),[2]}}))}))},t.prototype.recreateWrapper=function(){var t=this;if(void 0===this.wrapper||this.wrapper.getChartType()!==this.data.chartType){this.dataTable=new l(this.data),this.dataTable.dataTableChanged.subscribe((function(e){t._draw()}));var e=this.data;if(this.data.firstRowIsData&&((e=Object.assign(e,this.data)).dataTable=this.dataTable.getDataTable()),this.wrapper=new google.visualization.ChartWrapper(e),this.registerChartWrapperEvents(),void 0===e.dataTable&&void 0===e.dataSourceUrl)try{this.wrapper.draw(this.HTMLel)}catch(t){}}},t.prototype._draw=function(){return n(this,void 0,void 0,(function(){var t;return i(this,(function(e){return void 0===(t=this.dataTable.getDataTable())?[2]:(this.convertOptions(),this.recreateWrapper(),this.wrapper.setOptions(this.options),this.wrapper.setDataTable(t),this.wrapper.draw(this.HTMLel),[2])}))}))},t.prototype.getDataTable=function(){return this.dataTable},t.prototype.draw=function(t){void 0===t&&(t=this.data),this.options=t.options,this.dataTable.init(t)},t.prototype.getSelectorBySeriesType=function(t){return{bars:"bar#%s#%r",haxis:"hAxis#0#label",line:"point#%s#%r",legend:"legendentry#%s",area:"point#%s#%r"}[t]},t.prototype.getSeriesByColumn=function(t){for(var e=0,o=this.wrapper.getDataTable(),r=t-1;r>=0;r--){var n=o.getColumnRole(r),i=o.getColumnType(r);"data"!==n&&"number"!==i||e++}return e},t.prototype.getBoundingBoxForItem=function(t){var e={top:0,left:0,width:0,height:0};if(this.cli){var o=t.column,r=this.getSeriesByColumn(o),n=t.row,i=this.options.seriesType;if(this.options.series&&this.options.series[r]&&this.options.series[r].type&&(i=this.options.series[r].type),i){var a=this.getSelectorBySeriesType(i);if(a){a=a.replace("%s",r+"").replace("%c",o+"").replace("%r",n+"");var s=this.cli.getBoundingBox(a);s&&(e=s)}}}return e},t.prototype.getValueAtPosition=function(t){return null==t.row?null:this.wrapper.getDataTable().getValue(t.row,t.column)},t.prototype.getColumnTypeAtPosition=function(t){return this.wrapper.getDataTable().getColumnType(t.column)||""},t.prototype.getColumnLabelAtPosition=function(t){return this.wrapper.getDataTable().getColumnLabel(t.column)||""},t.prototype.getHTMLTooltip=function(){var t=new e.ElementRef(this.el.nativeElement.querySelector(".google-visualization-tooltip"));return new u(t)},t.prototype.parseMouseEvent=function(t){var e=this.wrapper.getChartType(),o=t.column;if(null==o)switch(e){case"Timeline":o=3===this.wrapper.getDataTable().getNumberOfColumns()?0:1;break;default:o=0}var r={row:t.row,column:o};return{position:t,boundingBox:this.getBoundingBoxForItem(r),value:this.getValueAtPosition(r),columnType:this.getColumnTypeAtPosition(r),columnLabel:this.getColumnLabelAtPosition(r)}},t.prototype.unregisterEvents=function(){google.visualization.events.removeAllListeners(this.wrapper.getChart()),google.visualization.events.removeAllListeners(this.wrapper)},t.prototype.registerChartEvents=function(){var t=this,e=this.wrapper.getChart();this.cli=e.getChartLayoutInterface?e.getChartLayoutInterface():null,this.mouseOver.observers.length>0&&google.visualization.events.addListener(e,"onmouseover",(function(e){var o=t.parseMouseEvent(e);o.tooltip=t.getHTMLTooltip(),t.mouseOver.emit(o)})),this.mouseOverOneTime.observers.length>0&&google.visualization.events.addOneTimeListener(e,"onmouseover",(function(e){var o=t.parseMouseEvent(e);o.tooltip=t.getHTMLTooltip(),t.mouseOverOneTime.emit(o)})),this.mouseOut.observers.length>0&&google.visualization.events.addListener(e,"onmouseout",(function(e){var o=t.parseMouseEvent(e);t.mouseOut.emit(o)})),this.mouseOutOneTime.observers.length>0&&google.visualization.events.addOneTimeListener(e,"onmouseout",(function(e){var o=t.parseMouseEvent(e);t.mouseOutOneTime.emit(o)})),"GeoChart"===this.data.chartType&&(this.regionClick.observers.length>0&&google.visualization.events.addListener(e,"regionClick",(function(e){t.regionClick.emit(e)})),this.regionClickOneTime.observers.length>0&&google.visualization.events.addOneTimeListener(e,"regionClick",(function(e){t.regionClick.emit(e)})))},t.prototype.registerChartWrapperEvents=function(){var t=this;google.visualization.events.addListener(this.wrapper,"ready",(function(){t.chartReady.emit({message:"Chart ready"})})),google.visualization.events.addOneTimeListener(this.wrapper,"ready",(function(){t.chartReadyOneTime.emit({message:"Chart ready (one time)"}),t.registerChartEvents()})),google.visualization.events.addListener(this.wrapper,"error",(function(e){t.chartError.emit(e)})),google.visualization.events.addOneTimeListener(this.wrapper,"error",(function(e){t.chartErrorOneTime.emit(e)})),this.addListener(this.wrapper,"select",this.selectListener,this.chartSelect),this.addOneTimeListener(this.wrapper,"select",this.selectListener,this.chartSelectOneTime)},t.prototype.addListener=function(t,e,o,r){google.visualization.events.addListener(t,e,(function(){r.emit(o())}))},t.prototype.addOneTimeListener=function(t,e,o,r){google.visualization.events.addOneTimeListener(t,e,(function(){r.emit(o())}))},t.prototype.convertOptions=function(){try{this.options=google.charts[this.data.chartType].convertOptions(this.options)}catch(t){return}},t.ctorParameters=function(){return[{type:e.ElementRef},{type:s}]},o([e.Input()],t.prototype,"data",void 0),o([e.Output()],t.prototype,"chartReady",void 0),o([e.Output()],t.prototype,"chartReadyOneTime",void 0),o([e.Output()],t.prototype,"chartError",void 0),o([e.Output()],t.prototype,"chartErrorOneTime",void 0),o([e.Output()],t.prototype,"chartSelect",void 0),o([e.Output()],t.prototype,"chartSelectOneTime",void 0),o([e.Output()],t.prototype,"mouseOver",void 0),o([e.Output()],t.prototype,"mouseOverOneTime",void 0),o([e.Output()],t.prototype,"mouseOut",void 0),o([e.Output()],t.prototype,"mouseOutOneTime",void 0),o([e.Output()],t.prototype,"regionClick",void 0),o([e.Output()],t.prototype,"regionClickOneTime",void 0),t=o([e.Component({selector:"google-chart",template:"<div></div>"})],t)}(),p=function(){function t(t,e){this.el=t,this.loaderService=e}return t.prototype.ngOnInit=function(){var t=this;this.data.component=this,this.init().then((function(){t.dataTable||(t.dataTable=new l(t.data),t.dataTable.dataTableChanged.subscribe((function(e){t._draw()}))),t.draw()}))},t.prototype.init=function(){return n(this,void 0,void 0,(function(){var t,e,o,r,n,s,l,u,c,p,h,d,g,v,f,m,y,b,w,T;return i(this,(function(i){switch(i.label){case 0:return[4,this.loaderService.load({packages:["controls"]})];case 1:i.sent(),this.dashboard=new google.visualization.Dashboard(this.el.nativeElement.querySelector("div")),i.label=2;case 2:i.trys.push([2,21,22,23]),t=a(this.data.bind),e=t.next(),i.label=3;case 3:if(e.done)return[3,20];o=e.value,r=o[0],n=o[1],r instanceof Array||(r=[r]),n instanceof Array||(n=[n]),i.label=4;case 4:i.trys.push([4,9,10,11]),y=void 0,s=a(r),l=s.next(),i.label=5;case 5:return l.done?[3,8]:[4,(h=l.value).component.ensureInit()];case 6:i.sent(),i.label=7;case 7:return l=s.next(),[3,5];case 8:return[3,11];case 9:return u=i.sent(),y={error:u},[3,11];case 10:try{l&&!l.done&&(b=s.return)&&b.call(s)}finally{if(y)throw y.error}return[7];case 11:i.trys.push([11,16,17,18]),w=void 0,c=a(n),p=c.next(),i.label=12;case 12:return p.done?[3,15]:[4,(h=p.value).component.init()];case 13:if(i.sent(),void 0!==(d=h.component.data).dataTable||void 0!==d.dataSourceUrl)throw Error("dataTable and dataSourceUrl cannot be specified when chart is drawn in a Dashboard");i.label=14;case 14:return p=c.next(),[3,12];case 15:return[3,18];case 16:return g=i.sent(),w={error:g},[3,18];case 17:try{p&&!p.done&&(T=c.return)&&T.call(c)}finally{if(w)throw w.error}return[7];case 18:this.dashboard.bind(r.map((function(t){return t.component.wrapper})),n.map((function(t){return t.component.wrapper}))),i.label=19;case 19:return e=t.next(),[3,3];case 20:return[3,23];case 21:return v=i.sent(),f={error:v},[3,23];case 22:try{e&&!e.done&&(m=t.return)&&m.call(t)}finally{if(f)throw f.error}return[7];case 23:return[2]}}))}))},t.prototype.draw=function(t){this.dataTable.init(t)},t.prototype._draw=function(){this.dashboard.draw(this.dataTable.getDataTable())},t.ctorParameters=function(){return[{type:e.ElementRef},{type:s}]},o([e.Input()],t.prototype,"data",void 0),t=o([e.Component({selector:"google-charts-dashboard",template:"<div></div>"})],t)}(),h=function(){function t(t,e){this.el=t,this.loaderService=e}return t.prototype.ngOnInit=function(){this.data.component=this},t.prototype.ensureInit=function(){return n(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return this.wrapper?[2]:[4,this.loaderService.load({packages:["controls"]})];case 1:return e.sent(),(t=Object.create(this.data)).containerId=this.el.nativeElement.querySelector("div"),this.wrapper=new google.visualization.ControlWrapper(t),[2]}}))}))},t.ctorParameters=function(){return[{type:e.ElementRef},{type:s}]},o([e.Input()],t.prototype,"data",void 0),t=o([e.Component({selector:"google-charts-control",template:"<div></div>"})],t)}(),d=function(){function t(){}return t=o([e.NgModule({declarations:[c,p,h],providers:[s],exports:[c,p,h]})],t)}();t.ChartHTMLTooltip=u,t.GoogleChartComponent=c,t.GoogleChartsControlComponent=h,t.GoogleChartsDashboardComponent=p,t.GoogleChartsLoaderService=s,t.Ng2GoogleChartsModule=d,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ng2-google-charts.umd.min.js.map